<!doctype html>

<html lang="en-us">

<head>
    <!-- Global site tag (gtag.js) - Google Analytics (UA) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-10002990-14"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-10002990-14');
    </script>
    <!-- End Global site tag (gtag.js) - Google Analytics (UA) -->

    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WKN9J9K');</script>
    <!-- End Google Tag Manager -->

    <!-- Hotjar Tracking Code for https://mybus.metro.net -->
    <script>
        (function (h, o, t, j, a, r) {
            h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
            h._hjSettings = { hjid: 2090649, hjsv: 6 };
            a = o.getElementsByTagName('head')[0];
            r = o.createElement('script'); r.async = 1;
            r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
            a.appendChild(r);
        })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
    </script>
    <!-- End Hotjar Tracking Code for https://mybus.metro.net -->

    <meta charset="utf-8">

    <title>Is my bus line changing?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;600&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="css/jquery-ui.css">
    <link rel="stylesheet" href="css/styles.css">

    <!-- Facebook Pixel Code -->
    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '550515235555198');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
            src="https://www.facebook.com/tr?id=550515235555198&ev=PageView&noscript=1" /></noscript>
    <!-- End Facebook Pixel Code -->

    <!-- StackAdapt Universal Pixel Code -->
    <script>!function (s, a, e, v, n, t, z) { if (s.saq) return; n = s.saq = function () { n.callMethod ? n.callMethod.apply(n, arguments) : n.queue.push(arguments) }; if (!s._saq) s._saq = n; n.push = n; n.loaded = !0; n.version = '1.0'; n.queue = []; t = a.createElement(e); t.async = !0; t.src = v; z = a.getElementsByTagName(e)[0]; z.parentNode.insertBefore(t, z) }(window, document, 'script', 'https://tags.srv.stackadapt.com/events.js'); saq('ts', 'QaVjAwgftZpBJMIVlvENsQ');</script>
    <!-- End StackAdapt Universal Pixel Code -->

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WKN9J9K" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <nav class="navbar navbar-dark bg-dark">
        <a class="navbar-brand" href="https://metro.net">
            <img src="img/M-Metro_reversed_128h.png" height="36" alt="logo">
        </a>
    </nav>

    <div class="container">
        <div class="row pt-3 mx-4">
            <div class="col"></div>
            <div class="col-lg-6">
                <h1 class="my-4"><span lang="en">Is my bus line changing? <span
                            class="badge badge-secondary">beta</span>
                        <!--<span lang="es">¿Está cambiando mi autobús?</span>-->
                </h1>
                <p>
                    <a id="switchLanguage" class="languageIcon black mt-1" role="button" data-toggle="collapse"
                        href="#collapseLanguages" aria-expanded="false" aria-controls="collapseLanguages"><img
                            src="img/language_icon.png" alt="select language"></a>
                </p>
                <div id="collapseLanguages" class="collapse">
                    <a class="languageSelection" lang="hy" data-language="Armenian"
                        href="docs/21-1632_NextGen_Phase1_TK1_jp-Armenian.pdf">Ներբեռնեք ավտոբուսային գծերի ցուցակը
                        սպասարկման փոփոխություններով.</a>
                    <a class="languageSelection" lang="zh-Hant" data-language="Chinese (traditional)"
                        href="docs/21-1632_NextGen_Phase1_TK1_jp-Chinese.pdf">下载带有服务更改的公交线路的单子。</a>
                    <a class="languageSelection" lang="ja" data-language="Japanese"
                        href="docs/21-1632_NextGen_Phase1_TK1_jp-Japanese.pdf">サービスが変更されたバス路線のリストをダウンロードします。</a>
                    <a class="languageSelection" lang="ko" data-language="Korean"
                        href="docs/21-1632_NextGen_Phase1_TK1_jp-Korean.pdf">버스 노선 변경사항을 안내하는 목록을 다운로드하십시오.</a>
                    <a class="languageSelection" lang="ru" data-language="Russian"
                        href="docs/21-1632_NextGen_Phase1_TK1_jp-Russian.pdf">Скачать список автобусных линий с
                        изменениями маршрута.</a>
                    <a class="languageSelection" lang="es" data-language="Spanish"
                        href="docs/21-1632_NextGen_Phase1_TK1_Spanish.pdf">Descargue la lista de líneas de autobús con
                        cambios en el servicio.</a>
                    <a class="languageSelection" lang="vi" data-language="Vietnamese"
                        href="docs/21-1632_NextGen_Phase1_TK1_jp-Vietnamese.pdf">Tải xuống danh sách các tuyến xe buýt
                        có thay đổi dịch vụ.</a>
                </div>
            </div>
            <div class="col"></div>
        </div>

        <div class="row mt-3 mx-4 mb-5">
            <div class="col"></div>
            <div class="col-lg-6">
                <p>Metro periodically updates bus service to improve your ride. Latest updates effective December 13,
                    2020.</p>

                <form id="busQuery" onSubmit="return false;" autocomplete="off">
                    <div class="form-group">
                        <label for="myBusLine"><span lang="en">Which bus line do you ride?</span></label>
                        <input type="text" class="form-control" id="myBusLine" placeholder="select your line">
                    </div>
                </form>
            </div>
            <div class="col"></div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="js/jquery-ui.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>

    <script>
        /**
         * Handle language switching.
         */

        $('#switchLanguage img').hover(function () {
            if (!$(this).hasClass('showLanguages')) {
                $(this).attr('src', 'img/language_icon_active.png');
            }
        }, function () {
            if (!$(this).hasClass('showLanguages')) {
                $(this).attr('src', 'img/language_icon.png');
            }
        });

        $('#switchLanguage img').click(function () {
            $(this).toggleClass('showLanguages');

            if ($(this).hasClass('showLanguages')) {
                $(this).attr('src', 'img/language_icon_active.png');
            } else {
                $(this).attr('src', 'img/language_icon.png');
            }
        });

        /**
         * Manually define list of bus lines (needs to match the Google Sheet's first column)
         */

        const currentLines = ['2', '4', '10', '14/37', '16', '18', '20', '28', '30', '33', '35/38', '40', '45', '48', '51/52', '53', '55', '60', '62', '66', '68', '70', '71', '76', '78/79', '81', '83', '90/91', '92', '94', '96', '102', '105', '106', '108', '110', '111', '115', '117', '120', '125', '126', '127', '128', '130', '150/240', '152', '154', '155', '158', '161', '162/163', '164', '165', '166', '167', '169', '175', '176', '177', '180/181', '183', '200', '201', '202', '204', '205', '206', '207', '209', '210', '211/215', '212', '217', '218', '222', '224', '230', '232', '233', '234', '236', '237/656', '239', '242/243', '245', '246', '251', '252', '254', '256', '258', '260', '265', '266', '264/267', '268', '302', '312', '316', '330', '344', '351', '353', '355', '358', '364', '378', '442', '460', '487/489', '501', '534', '550', '577', '601', '602', '603', '605', '607', '611', '612', '625', '665', '685', '686/687', '704', '705', '710', '720', '728', '733', '734', '740', '744', '745', '750', '751', '754', '757', '760', '762', '770', '780', '794', '901 - G Line (Orange)', '910/950 - J Line (Silver)', '834 - L Line (Gold) Shuttle'];

        function isValidBusLine() {
            let inputEntry = $('#myBusLine').val();
            let index = currentLines.indexOf(inputEntry);
            if (index > 0) {
                return true;
            } else {
                return false;
            }
        }

        $('#myBusLine').autocomplete({
            source: currentLines,
            autoFocus: true,
            minLength: 0
        }).focus(function () {
            $('#myBusLine').autocomplete('search');
        });

        // Handle Enter key being pressed (even when no item in list is selected)
        $('#myBusLine').keydown(function(e) {
            if (e.keyCode == 13) {
                e.preventDefault();
                if (isValidBusLine()) {
                    window.location = 'bus.html?line=' + $('#myBusLine').val();
                }
            }
        });

        // Attempt to handle iOS keyboard "Done" button
        $('#myBusLine').focusout(function(e) {
            if (isValidBusLine()) {
                window.location = 'bus.html?line=' + $('#myBusLine').val();
            }
        });

        // Handles selection from dropdown list
        $('#myBusLine').on('autocompleteselect', function (e, ui) {
            $('#myBusLine').val(ui.item.value);

            if (isValidBusLine()) {
                window.location = 'bus.html?line=' + ui.item.value;
            }
        });
    </script>
</body>

</html>